"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.router = void 0;
const express_1 = require("express");
const upload_1 = require("../controllers/upload");
const ingestWebhook_1 = require("../controllers/ingestWebhook");
const alerts_1 = require("../controllers/alerts");
const multer_1 = require("../middleware/multer");
const threats_1 = require("../controllers/threats");
const similarity_search_1 = require("../controllers/similarity-search");
const rules_1 = require("../controllers/rules");
exports.router = (0, express_1.Router)();
exports.router.post("/upload", multer_1.multerConfig, upload_1.handleFileUpload);
exports.router.post("/ingest/webhook", ingestWebhook_1.ingestEventWebhook);
exports.router.get("/alerts", alerts_1.listAlerts);
exports.router.get("/threats", threats_1.listThreats);
exports.router.post("/similarity-search", similarity_search_1.findSimilarity);
exports.router.post("/rules", rules_1.createRule);
exports.router.get("/rules", rules_1.listRules);
exports.router.patch("/rules", rules_1.updateRule);
