"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.auditRouter = exports.router = void 0;
const express_1 = require("express");
const upload_1 = require("../controllers/upload");
const alerts_1 = require("../controllers/alerts");
const multer_1 = require("../middleware/multer");
const threats_1 = require("../controllers/threats");
const rules_1 = require("../controllers/rules");
const auth_1 = require("../middleware/auth");
const download_1 = require("../controllers/download");
exports.router = (0, express_1.Router)();
exports.auditRouter = exports.router;
exports.router.post("/upload", auth_1.authenticateTokenOrApiKey, multer_1.multerConfig, upload_1.handleFileUpload);
exports.router.get("/upload", auth_1.authenticateTokenOrApiKey, upload_1.uploadList);
exports.router.get("/download/:uploadId", auth_1.authenticateTokenOrApiKey, download_1.downloadUpload);
exports.router.get("/alerts", auth_1.authenticateTokenOrApiKey, alerts_1.listAlerts);
exports.router.get("/threats", auth_1.authenticateTokenOrApiKey, threats_1.listThreats);
exports.router.get("/threats/:threatId/analysis", auth_1.authenticateTokenOrApiKey, threats_1.getThreatDetails);
exports.router.post("/rules", auth_1.authenticateTokenOrApiKey, (0, auth_1.requireRole)(["ADMIN", "MANAGER"]), rules_1.createRule);
exports.router.get("/rules", auth_1.authenticateTokenOrApiKey, rules_1.listRules);
exports.router.patch("/rules", auth_1.authenticateTokenOrApiKey, (0, auth_1.requireRole)(["ADMIN", "MANAGER"]), rules_1.updateRule);
